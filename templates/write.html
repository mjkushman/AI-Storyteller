{% extends 'base.html'%}
{% block title %}AI Cowriter {% endblock %}


{% block content %}

<div class="container text-center">
  <h1 class="display-4">Write along with AI</h1>
</div>

<div class="row align-items-center">

{# user id is {{user.id}} #}
<div class="context-form {{context_display}}">
  <div class="container col-md-5 mx-auto">
          <div class="text-center"> <p>Choose a genre and starting story prompt.</p>
          <p>Take turns writing the story with an AI co-writer.</p></div>
      <div class="storyContext container-fluid mx-auto" id="contextDiv">
        
        {#  Context Form start  #}
        <form action="" method="GET" id="contextForm">
          <div class="container text-center">
              
              <div class="col text-center">
                <button id="randomizePrompt" type="button" class="btn btn-outline-secondary">Randomize genre and prompt</button>
              </div>

            {#  Genre  #}
          <div class="form mb-3 text-center">
              {{contextForm.genre(class_='')}} 
          </div>

            {#  Prompt #}
            <div class="form mb-3 text-center">
              <div>{{contextForm.story_prompt(class_='', rows_='2')}}
              {% for err in contextForm.story_prompt.errors %}<small class="form-text">{{err}}</small>{% endfor %}
              </div> 
            </div>
          
          {#  randomize and submit buttons #}
          <div class="container">
            <div class="row justify-content-center">

              <div class="col">
                <div class="container"><button id="contextSubmit" class="btn btn-outline-primary btn-lg submit">Start Writing</button>
                </div>

              </div>

            </div>

            <div class="row">
              
            </div>
          </div>
        
         </div>
         </form>

         {#  Context Form end  #}
      </div>
  </div>
</div>

{# Story submission form #}
<div class="container contribution-form {{contribution_display}}">
  
    {# Story starts here #}
    <div id="story" class="col-md-8 mx-auto">


      <p id="storyGenreHeadline">{% if genre %} {{genre}} {% endif %} Story</p>
      <span id="storyPromptHeadline">{% if story %}{{ story.story_prompt }}{% endif %}</span>
  
      {% for contribution in contributions %}
          <span class="{{contribution['role']}}">{{contribution['content']}}</span>
          {% endfor %}
        <div class="typing-message" id="typing-message" style="display: none;">
          <span class="typing-dots"></span>
          <span class="typing-dots"></span>
          <span class="typing-dots"></span>
        </div>
    </div>
  {# End of Story #}

{# contribution form #}
  <div class="container col-md-6 mx-auto">
    <form action="" method="POST" id="inputForm">
      {{ story_form.hidden_tag() }} {{ story_form.story_id }}
      
      <div class="container">
      <div class="form-group mb-3">
        <small id="turn-notice">Write more to this story or skip your turn.</small>
        {{story_form.body(class_='contribution-area', rows_='3')}}
        {# {{story_form.body.label(class_='form-label')}} #}
      </div>
      
      </div>



        <small class="form-text"
          >{% for err in story_form.body.errors %} {{err}} {% endfor %}
        </small>
    
  
  
      <div class="container text-center">
        <button id="storySubmit" class="btn btn-primary btn-lg submit">Add</button>
        <button id="skipTurn" class="btn btn-outline-primary btn-md skip-turn">Skip</button>
      </div>
    </form>
  </div>
{# End submission form #}

<div class="container text-center restart-btn">
<div class="row"><div class="col">
<!-- NEW STORY BUTTON -->
<button class="btn btn-outline-secondary" id="newStoryBtn">Start Over</button>
</div>
      <!-- Sign in link -->
      {% if not user%}
      <p>
        <a href="/sign-in">Sign in</a> to save this story.
      </p>
        {% else %}
        <p>Story is saved automatically.</p>
      {% endif %}
</div>
</div>



</div>
{#  End contribution section #}
  




</div>


{% endblock %}